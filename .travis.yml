language: node_js
node_js:
  - 10
env:
  global:
    - RELEASE_VERSION=1.2
    - PROD_URL=Prod/${RELEASE_VERSION}
    - UAT_URL=UAT/${RELEASE_VERSION}
cache:
  directories:
  - node_modules
install:
- npm install
provider: script
script:
  - 'if ${TRAVIS_PULL_REQUEST_BRANCH} == "test-branch"; then
    bash before_uat_scripts.sh  
  fi'
  - 'if ${TRAVIS_PULL_REQUEST_BRANCH} == "test-branch"; then
    bash before_prod_scripts.sh  
  fi'
deploy:
  provider: s3
  access_key_id: $AWS_ACCESS_KEY_ID
  secret_access_key: $AWS_SECRET_ACCESS_KEY
  bucket: $S3_BUCKET_UAT
  skip_cleanup: true
  upload-dir: 1.2
  on:
    branch: test-branch
deploy:
  provider: s3
  access_key_id: $AWS_ACCESS_KEY_ID
  secret_access_key: $AWS_SECRET_ACCESS_KEY
  bucket: $S3_BUCKET
  skip_cleanup: true
  on:
    branch: master


